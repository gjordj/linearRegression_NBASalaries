"0","library(MASS)"
"0",""
"0","regfit.bwd=regsubsets(Salary~ NBA_DraftNumber+Age+Tm+G+MP+PER+TS+PAr+FTr+"
"0","              ORB+DRB+TRB+AST+STL+BLK+TOV+USG+OWS+DWS+"
"0","              WS+WSM+OBPM+DBPM+BPM+VORP,mData,method =""backward"")"
"0",""
"0",""
"0",""
"0","IC<-summary (regfit.bwd )"
"0",""
"0",""
"0",""
"0","for(i in 1:length(IC$bic)){"
"0","   if(IC$bic[i] == sort(IC$bic)[1]){"
"0","    first_best = i"
"0","   }"
"0","  "
"0","  if(IC$bic[i] == sort(IC$bic)[2]){"
"0","    second_best = i"
"0","  }"
"0"," "
"0","   if(IC$bic[i] == sort(IC$bic)[3]){"
"0","    third_best = i"
"0","   }"
"0","   if(IC$bic[i] == sort(IC$bic)[4]){"
"0","    fourth_best = i"
"0","   }"
"0","}"
"0","backward_stepwise_ic<-IC$bic[first_best]"
"0","print(IC$bic[first_best])"
"1","[1]"
"1"," -328.5835"
"1","
"
"0","print(IC$bic[second_best])"
"1","[1]"
"1"," -325.8103"
"1","
"
"0","print(IC$bic[third_best])"
"1","[1]"
"1"," -322.4556"
"1","
"
"0","print(IC$bic[fourth_best])"
"1","[1]"
"1"," -318.8299"
"1","
"
"0","#########"
"0","# PSEUDO#"
"0","#########"
"0","# Get variable names used in a model."
"0","# Get first 4 models with best BIC, its variable names used in the model."
"0","# Get variable names used in best 4 models based on BIC."
"0","# Create the 4 best models based on BIC."
"0",""
"0","model<-as.data.frame(IC$which[first_best,])"
"0","names(model)[1]<-""used"""
"0","parameters_model_first<-c()"
"0","for(i in 1:dim(model)[1]){"
"0","  if(model$used[i] == TRUE){"
"0","    parameters_model_first<- parameters_model_first%>%append(row.names(model)[i])"
"0","  }"
"0","}"
"0",""
"0","model<-as.data.frame(IC$which[second_best,])"
"0","names(model)[1]<-""used"""
"0","parameters_model_second<-c()"
"0","for(i in 1:dim(model)[1]){"
"0","  if(model$used[i] == TRUE){"
"0","    parameters_model_second<- parameters_model_second%>%append(row.names(model)[i])"
"0","  }"
"0","}"
"0",""
"0","model<-as.data.frame(IC$which[third_best,])"
"0","names(model)[1]<-""used"""
"0","parameters_model_third<-c()"
"0","for(i in 1:dim(model)[1]){"
"0","  if(model$used[i] == TRUE){"
"0","    parameters_model_third<- parameters_model_third%>%append(row.names(model)[i])"
"0","  }"
"0","}"
"0",""
"0","model<-as.data.frame(IC$which[fourth_best,])"
"0","names(model)[1]<-""used"""
"0","parameters_model_fourth<-c()"
"0","for(i in 1:dim(model)[1]){"
"0","  if(model$used[i] == TRUE){"
"0","    parameters_model_fourth<- parameters_model_fourth%>%append(row.names(model)[i])"
"0","  }"
"0","}"
"0",""
"0","# Eliminamos variable Intercept de la muestra."
"0","parameters_model_first<-parameters_model_first[-1]"
"0","parameters_model_second<-parameters_model_second[-1]"
"0","parameters_model_third<-parameters_model_third[-1]"
"0","parameters_model_fourth<-parameters_model_fourth[-1]"
"0",""
"0",""
"0","for(i in 1:length(parameters_model_first)){"
"0","  if(parameters_model_first[i] == ""TmHOU""){"
"0","    parameters_model_first[i]=""HOU"""
"0","  }"
"0","}"
"0","for(i in 1:length(parameters_model_second)){"
"0","  if(parameters_model_second[i] == ""TmHOU""){"
"0","    parameters_model_second[i]=""HOU"""
"0","  }"
"0","}"
"0","for(i in 1:length(parameters_model_third)){"
"0","  if(parameters_model_third[i] == ""TmHOU""){"
"0","    parameters_model_third[i]=""HOU"""
"0","  }"
"0","}"
"0","for(i in 1:length(parameters_model_fourth)){"
"0","  if(parameters_model_fourth[i] == ""TmHOU""){"
"0","    parameters_model_fourth[i]=""HOU"""
"0","  }"
"0","}"
"0",""
"0","# "
"0","# # Correct TmHou"
"0","# for (i in 1:length(parameters_model_first)){"
"0","#   if(""TmHOU"" %in% parameters_model_first[i]){"
"0","#     parameters_model_first[i]<-""Tm""}"
"0","# }"
"0","# "
"0","# for (i in 1:length(parameters_model_second)){"
"0","#   if(""TmHOU"" %in% parameters_model_second[i]){"
"0","#     parameters_model_second[i]<-""Tm""}"
"0","# }"
"0","# "
"0","# for (i in 1:length(parameters_model_third)){"
"0","#   if(""TmHOU"" %in% parameters_model_third[i]){"
"0","#     parameters_model_third[i]<-""Tm""}"
"0","# }"
"0","# "
"0","# for (i in 1:length(parameters_model_fourth)){"
"0","#   if(""TmHOU"" %in% parameters_model_fourth[i]){"
"0","#     parameters_model_fourth[i]<-""Tm""}"
"0","# }"
"0",""
"0","# parameters_model_first"
"0","# parameters_model_second"
"0","# parameters_model_third"
"0","# parameters_model_fourth"
"0",""
"0","parameters_model_first_backward_stepwise<-parameters_model_first"
"0","parameters_model_second_backward_stepwise<-parameters_model_second"
"0","parameters_model_third_backward_stepwise<-parameters_model_third"
"0","parameters_model_fourth_backward_stepwise<-parameters_model_fourth"
"0",""
"0","##################################################################################"
"0","# CREATION OF THE BEST 4 MODELS OUT OF THE 8 WITH BEST BIC AUTOMATICALLY SELECTED#"
"0","##################################################################################"
"0","#Create first best model"
"0","check <-mData"
"0",""
"0","check<-check%>%mutate(HOU=0)  "
